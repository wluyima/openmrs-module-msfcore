<htmlform
	formUuid="5ec65100-d821-11e8-a2f8-07cd972bc32b"
	formName="Request Appointment Followup"
	formEncounterType="4aa6553b-be5a-413a-93fc-23962bc594e8"
	formVersion="1.1" formAddMetadata="no">
	<!-- Autogenerated example form  (template from 01-Nov-2010 -->
	<macros>
		paperFormId = (Fill this in)
		headerColor =#009d8e
		fontOnHeaderColor = white
	</macros>

	<script type="text/javascript">
		if (jQuery) {

            // validation of the request appointment date
            beforeSubmit.push(function () {
                <!-- clear the previous errors -->
                setValue('appointment_next_date.error', '');

                var encounterDate = new Date((getValue('encounterDate.value')));
                var appointment_next_date = new Date((getValue('appointment_next_date.value')));

                if (encounterDate &gt;= appointment_next_date) {
                    getField('appointment_next_date.error').html('The appointment date must be after the date of this visit ' + encounterDate).show();
                    return false;
                }

                return true;
            });
		
			jq(document).ready(function () {
				<ifMode mode="VIEW">
					<!-- hide the buttons in view -->
					jq('button.no-print').hide();
				</ifMode>

				<!-- handle operation buttons -->
				jq(".msf-operation-button").on("click", function() {
					jq("#msf-operation").attr("value", this.value);
					return true;
				});

				jq("#appointment-type-list").on("change", function() {
					setValue("appointment-type.value",
					jq("#appointment-type-list").val());
				});
	
				jq("#appointment-type-list").val(getValue("appointment-type.value"));


			});
		}
	</script>

	<div class="wrapper">
		<uiInclude provider="msfcore" fragment="followupLeftMenu"/>
		<div class="right-form-display">
            <div style="display:none;">
                <section headerLabel="Encounter Details">
                    <table class="baseline-aligned">
                        <tr>
                            <td>Date:</td>
                            <td>
                                <encounterDate default="now" disallowMultipleEncountersOnDate="block" showTime="true" />
                            </td>
                        </tr>
                        <tr>
                            <td>Location:</td>
                            <td>
                                <encounterLocation default="SessionAttribute:emrContext.sessionLocationId"/>
                            </td>
                        </tr>
                        <tr>
                            <td>Provider:</td>
                            <td>
                                <encounterProvider default="currentUser"/>
                            </td>
                        </tr>
                    </table>
                </section>
            </div>

			<div class="sections-container">
				<section>
					<H3><a name="requestappointmentfollowup">8. <lookup expression="fn.message('msfcore.ncdbaseline.requestappointment.title')"/></a></H3>
					<div>
						<h4><lookup expression="fn.getConcept('MSF:4970888B-5114-4D8D-A8F6-B6110ECF330A').name" /></h4>
						<!-- Concept id ref term=581373 name=appointment_next_date -->
						<obs conceptId="MSF:4970888B-5114-4D8D-A8F6-B6110ECF330A" id="appointment_next_date" allowFutureDates="true" allowTime="false" />
					</div>
					<div>
						<h4><lookup expression="fn.message('msfcore.ncdbaseline.requestappointment.servicetype')" /></h4>
						<!-- Concept id=6000009 name = Request Appointment Type -->
						<span style="display:none;"><obs id="appointment-type" conceptId="d0475b32-6987-43b3-a618-b975f4967ba5" /></span>
						<uiInclude provider="msfcore" fragment="field/appointmentList"/>

					</div>
					<div>
						<h4><lookup expression="fn.getConcept('f3a76818-3ff4-4d94-9c51-be295cad43a1').name" /></h4>
						<!-- Concept id=6000000 name=Request Appointment Comment -->
						<obs conceptId="f3a76818-3ff4-4d94-9c51-be295cad43a1" id="appointment_next_comment" rows="4" cols="80" />
					</div>
					
		            <!-- Submit -->
					<div class="bottom-of-form">
						<button class="msf-operation-button no-print" value="ncd.followup.requestappointment.previous"><lookup expression="fn.message('msfcore.previous')"/></button>
						<button class="primary right msf-operation-button no-print" value="complete.action"><lookup expression="fn.message('msfcore.save.final')"/></button>
					</div>
				</section>
			</div>
		</div>
	</div>

	<postSubmissionAction class="org.openmrs.module.msfcore.formaction.handler.HtmlFormPostSubmissionAction" />
</htmlform>